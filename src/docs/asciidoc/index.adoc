= Backend API
:doctype: book
:toc: left
:toclevels: 3
:sectanchors:
:sectlinks:
:stylesdir: styles
:stylesheet: custom.css
:linkcss:

== Overview

[cols="1,3",options="header"]
|===
|항목 |설명
|Base URL|`http://localhost` (docker compose 로컬)
|Docs|`/docs`
|인증|대부분 `Authorization: Bearer <accessToken>`
|파일 다운로드|`/api/files/{fileId}/download` (브라우저 직접 렌더링)
|===

TIP: 이 문서는 **Spring REST Docs 테스트**에서 생성된 스니펫을 include 해서 만들어집니다.

== 1. Authentication

=== 로그인
include::{snippets}/auth-login/http-request.adoc[]
include::{snippets}/auth-login/request-fields.adoc[]
include::{snippets}/auth-login/http-response.adoc[]
include::{snippets}/auth-login/response-fields.adoc[]

=== 토큰 재발급(Refresh)
include::{snippets}/auth-refresh/http-request.adoc[]
include::{snippets}/auth-refresh/request-fields.adoc[]
include::{snippets}/auth-refresh/http-response.adoc[]
include::{snippets}/auth-refresh/response-fields.adoc[]

==== 실패: Refresh Token 재사용(401)
include::{snippets}/auth-refresh-401-reuse/http-response.adoc[]
include::{snippets}/auth-refresh-401-reuse/response-fields.adoc[]

=== 전 기기 로그아웃
include::{snippets}/auth-logout-all/http-request.adoc[]
include::{snippets}/auth-logout-all/request-headers.adoc[]
include::{snippets}/auth-logout-all/http-response.adoc[]

== 2. Users

=== 회원가입
include::{snippets}/users-create/http-request.adoc[]
include::{snippets}/users-create/request-fields.adoc[]
include::{snippets}/users-create/http-response.adoc[]
include::{snippets}/users-create/response-fields.adoc[]

==== 실패 응답
===== 400 Validation Error
include::{snippets}/users-create-400-validation/http-response.adoc[]
include::{snippets}/users-create-400-validation/response-fields.adoc[]

===== 409 Duplicate Email
include::{snippets}/users-create-409-duplicate-email/http-response.adoc[]
include::{snippets}/users-create-409-duplicate-email/response-fields.adoc[]

===== 409 Duplicate Handle
include::{snippets}/users-create-409-duplicate-handle/http-response.adoc[]
include::{snippets}/users-create-409-duplicate-handle/response-fields.adoc[]

=== 사용자 검색 (Cursor Paging)
include::{snippets}/users-search-200/http-request.adoc[]
include::{snippets}/users-search-200/request-headers.adoc[]
include::{snippets}/users-search-200/query-parameters.adoc[]
include::{snippets}/users-search-200/http-response.adoc[]
include::{snippets}/users-search-200/response-fields.adoc[]

==== 다음 페이지 조회 예시
include::{snippets}/users-search-200-next-page/http-request.adoc[]
include::{snippets}/users-search-200-next-page/request-headers.adoc[]
include::{snippets}/users-search-200-next-page/query-parameters.adoc[]
include::{snippets}/users-search-200-next-page/http-response.adoc[]
include::{snippets}/users-search-200-next-page/response-fields.adoc[]

==== 팔로잉 여부 포함 예시
include::{snippets}/users-search-200-following-flag/http-response.adoc[]
include::{snippets}/users-search-200-following-flag/response-fields.adoc[]

==== 실패 응답
===== 400 Bad Request (q blank)
include::{snippets}/users-search-400-q-blank/http-response.adoc[]
include::{snippets}/users-search-400-q-blank/response-fields.adoc[]

===== 400 Bad Request (size range)
include::{snippets}/users-search-400-size-range/http-response.adoc[]
include::{snippets}/users-search-400-size-range/response-fields.adoc[]

=== 프로필 조회
include::{snippets}/users-profile-get/http-request.adoc[]
include::{snippets}/users-profile-get/path-parameters.adoc[]
include::{snippets}/users-profile-get/http-response.adoc[]
include::{snippets}/users-profile-get/response-fields.adoc[]

== 3. Me

=== 내 정보 조회
include::{snippets}/me-200-ok/http-request.adoc[]
include::{snippets}/me-200-ok/request-headers.adoc[]
include::{snippets}/me-200-ok/http-response.adoc[]
include::{snippets}/me-200-ok/response-fields.adoc[]

==== 실패: 401 Unauthorized
include::{snippets}/me-401-unauthorized/http-response.adoc[]
include::{snippets}/me-401-unauthorized/response-fields.adoc[]

=== 내 프로필 수정
include::{snippets}/me-profile-update/http-request.adoc[]
include::{snippets}/me-profile-update/request-headers.adoc[]
include::{snippets}/me-profile-update/request-fields.adoc[]
include::{snippets}/me-profile-update/http-response.adoc[]
include::{snippets}/me-profile-update/response-fields.adoc[]

==== 실패: 다른 유저 파일 사용(403)
include::{snippets}/me-profile-update-403-forbidden-file/http-response.adoc[]
include::{snippets}/me-profile-update-403-forbidden-file/response-fields.adoc[]

== 4. Files

=== 파일 업로드
include::{snippets}/files-upload/http-request.adoc[]
include::{snippets}/files-upload/request-headers.adoc[]
include::{snippets}/files-upload/request-parts.adoc[]
include::{snippets}/files-upload/http-response.adoc[]
include::{snippets}/files-upload/response-fields.adoc[]

=== 파일 다운로드 (브라우저 렌더링)
include::{snippets}/files-download-200/http-request.adoc[]
include::{snippets}/files-download-200/path-parameters.adoc[]
include::{snippets}/files-download-200/response-headers.adoc[]

==== 304 Not Modified (ETag)
include::{snippets}/files-download-304/http-request.adoc[]
include::{snippets}/files-download-304/path-parameters.adoc[]
include::{snippets}/files-download-304/request-headers.adoc[]
include::{snippets}/files-download-304/response-headers.adoc[]

=== 썸네일 조회
include::{snippets}/files-thumbnail-200/http-request.adoc[]
include::{snippets}/files-thumbnail-200/path-parameters.adoc[]
include::{snippets}/files-thumbnail-200/response-headers.adoc[]

==== 304 Not Modified (ETag)
include::{snippets}/files-thumbnail-304/http-request.adoc[]
include::{snippets}/files-thumbnail-304/path-parameters.adoc[]
include::{snippets}/files-thumbnail-304/request-headers.adoc[]
include::{snippets}/files-thumbnail-304/response-headers.adoc[]

[NOTE]
====
파일 다운로드는 브라우저에서 직접 렌더링됩니다.

- `GET /api/files/{fileId}/download`
====

== 5. Follows

=== 팔로우
include::{snippets}/follows-create/http-request.adoc[]
include::{snippets}/follows-create/path-parameters.adoc[]
include::{snippets}/follows-create/request-headers.adoc[]
include::{snippets}/follows-create/http-response.adoc[]

==== 실패: 자기 자신 팔로우(400)
include::{snippets}/follows-create-400-self/http-response.adoc[]
include::{snippets}/follows-create-400-self/response-fields.adoc[]

=== 언팔로우
include::{snippets}/follows-delete/http-request.adoc[]
include::{snippets}/follows-delete/path-parameters.adoc[]
include::{snippets}/follows-delete/request-headers.adoc[]
include::{snippets}/follows-delete/http-response.adoc[]

== 6. Posts

=== 게시글 생성
include::{snippets}/posts-create/http-request.adoc[]
include::{snippets}/posts-create/request-headers.adoc[]
include::{snippets}/posts-create/request-fields.adoc[]
include::{snippets}/posts-create/http-response.adoc[]
include::{snippets}/posts-create/response-fields.adoc[]

[IMPORTANT]
====
요청은 두 방식을 모두 지원합니다.

- `imageFileIds` (권장): 파일 업로드 후 fileId(UUID)로 연결
- `imageUrls` (구버전 호환)
====

=== 게시글 단건 조회
include::{snippets}/posts-get/http-request.adoc[]
include::{snippets}/posts-get/request-headers.adoc[]
include::{snippets}/posts-get/path-parameters.adoc[]
include::{snippets}/posts-get/http-response.adoc[]
include::{snippets}/posts-get/response-fields.adoc[]

=== 게시글 삭제
include::{snippets}/posts-delete/http-request.adoc[]
include::{snippets}/posts-delete/request-headers.adoc[]
include::{snippets}/posts-delete/path-parameters.adoc[]
include::{snippets}/posts-delete/http-response.adoc[]

== 7. Post Likes

=== 좋아요
include::{snippets}/post-likes-create-204/http-request.adoc[]
include::{snippets}/post-likes-create-204/request-headers.adoc[]
include::{snippets}/post-likes-create-204/path-parameters.adoc[]
include::{snippets}/post-likes-create-204/http-response.adoc[]

=== 좋아요 취소
include::{snippets}/post-likes-delete-204/http-request.adoc[]
include::{snippets}/post-likes-delete-204/request-headers.adoc[]
include::{snippets}/post-likes-delete-204/path-parameters.adoc[]
include::{snippets}/post-likes-delete-204/http-response.adoc[]

== 8. Comments

=== 댓글 생성
include::{snippets}/comments-create-201/http-request.adoc[]
include::{snippets}/comments-create-201/request-headers.adoc[]
include::{snippets}/comments-create-201/path-parameters.adoc[]
include::{snippets}/comments-create-201/request-fields.adoc[]
include::{snippets}/comments-create-201/http-response.adoc[]
include::{snippets}/comments-create-201/response-fields.adoc[]

==== 실패: content blank(400)
include::{snippets}/comments-create-400-content-blank/http-response.adoc[]
include::{snippets}/comments-create-400-content-blank/response-fields.adoc[]

=== 댓글 목록(커서 페이징)
include::{snippets}/comments-list-200/http-request.adoc[]
include::{snippets}/comments-list-200/request-headers.adoc[]
include::{snippets}/comments-list-200/query-parameters.adoc[]
include::{snippets}/comments-list-200/http-response.adoc[]
include::{snippets}/comments-list-200/response-fields.adoc[]

==== 다음 페이지 예시
include::{snippets}/comments-list-200-next-page/http-response.adoc[]
include::{snippets}/comments-list-200-next-page/response-fields.adoc[]

==== 실패: cursor invalid(400)
include::{snippets}/comments-list-400-invalid-cursor/http-response.adoc[]
include::{snippets}/comments-list-400-invalid-cursor/response-fields.adoc[]

=== 댓글 삭제
include::{snippets}/comments-delete-204/http-request.adoc[]
include::{snippets}/comments-delete-204/request-headers.adoc[]
include::{snippets}/comments-delete-204/path-parameters.adoc[]
include::{snippets}/comments-delete-204/http-response.adoc[]

==== 실패: commentId invalid uuid(400)
include::{snippets}/comments-delete-400-invalid-uuid/http-response.adoc[]
include::{snippets}/comments-delete-400-invalid-uuid/response-fields.adoc[]

== 9. Feed

=== 피드 조회
include::{snippets}/feed-get/http-request.adoc[]
include::{snippets}/feed-get/request-headers.adoc[]
include::{snippets}/feed-get/query-parameters.adoc[]
include::{snippets}/feed-get/http-response.adoc[]
include::{snippets}/feed-get/response-fields.adoc[]

==== 다음 페이지 예시
include::{snippets}/feed-get-next-page/http-response.adoc[]
include::{snippets}/feed-get-next-page/response-fields.adoc[]

== 10. Conversations & Messages

=== 대화방 생성/조회(DIRECT)
include::{snippets}/conversations-direct-200/http-request.adoc[]
include::{snippets}/conversations-direct-200/request-headers.adoc[]
include::{snippets}/conversations-direct-200/request-fields.adoc[]
include::{snippets}/conversations-direct-200/http-response.adoc[]
include::{snippets}/conversations-direct-200/response-fields.adoc[]

=== 대화방 목록(커서 페이징)
include::{snippets}/conversations-list/http-request.adoc[]
include::{snippets}/conversations-list/request-headers.adoc[]
include::{snippets}/conversations-list/response-fields.adoc[]
include::{snippets}/conversations-list/http-response.adoc[]
include::{snippets}/conversations-list/response-fields.adoc[]

==== 다음 페이지 예시
include::{snippets}/conversations-list-200-next-page/http-response.adoc[]
include::{snippets}/conversations-list-200-next-page/response-fields.adoc[]

=== 메시지 목록(커서 페이징)
include::{snippets}/messages-get/http-request.adoc[]
include::{snippets}/messages-get/request-headers.adoc[]
include::{snippets}/messages-get/path-parameters.adoc[]
include::{snippets}/messages-get/query-parameters.adoc[]
include::{snippets}/messages-get/http-response.adoc[]
include::{snippets}/messages-get/response-fields.adoc[]

==== 다음 페이지 예시
include::{snippets}/messages-get-next-page/http-response.adoc[]
include::{snippets}/messages-get-next-page/response-fields.adoc[]

==== 실패: conversation not found(404)
include::{snippets}/messages-get-404-conversation-not-found/http-response.adoc[]
include::{snippets}/messages-get-404-conversation-not-found/response-fields.adoc[]

=== 메시지 목록 조회 시 자동 읽음 처리 예시
include::{snippets}/messages-get-auto-read/http-response.adoc[]

== 11. Notifications

=== 알림 목록
include::{snippets}/notifications-get-200/http-request.adoc[]
include::{snippets}/notifications-get-200/request-headers.adoc[]
include::{snippets}/notifications-get-200/query-parameters.adoc[]
include::{snippets}/notifications-get-200/http-response.adoc[]
include::{snippets}/notifications-get-200/response-fields.adoc[]

==== 다음 페이지 예시
include::{snippets}/notifications-get-200-next-page/http-response.adoc[]
include::{snippets}/notifications-get-200-next-page/response-fields.adoc[]

=== 알림 읽음 처리
include::{snippets}/notifications-read-200/http-request.adoc[]
include::{snippets}/notifications-read-200/request-headers.adoc[]
include::{snippets}/notifications-read-200/path-parameters.adoc[]
include::{snippets}/notifications-read-200/http-response.adoc[]

=== 알림 전체 읽음
include::{snippets}/notifications-read-all-200/http-request.adoc[]
include::{snippets}/notifications-read-all-200/request-headers.adoc[]
include::{snippets}/notifications-read-all-200/http-response.adoc[]

=== 읽은 알림 삭제
include::{snippets}/notifications-delete-read-200/http-request.adoc[]
include::{snippets}/notifications-delete-read-200/request-headers.adoc[]
include::{snippets}/notifications-delete-read-200/http-response.adoc[]

== 12. SSE

=== SSE 구독
include::{snippets}/sse-subscribe/http-request.adoc[]
include::{snippets}/sse-subscribe/request-headers.adoc[]
include::{snippets}/sse-subscribe/http-response.adoc[]
